dXdkz<-mARS0$coefficients["C:z"] ; if(is.na(dXdkz)){dXdkz<-0}
Zt0<-mean(females$z[which(females$t==1)])
kt0<-mean(females$C[which(females$t==1)])
Zt1<-mean(females$z[which(females$t==2)])
kt1<-mean(females$C[which(females$t==2)])
Xtt<-mean(log(females$ARS[which(females$t==1)]))
Xtt
XTT<-mean(log(females$ARS[which(females$t==2)]))
XTT
XtT<-intercept+Zt0*dXdz+kt1*dXdk
XtT
intercept+Zt1*dXdz+kt1*dXdk
Zkt1<-mean(females$C[which(females$t==1)]*females$z[which(females$t==1)])
Zkt1
Zt1kt2<-mean(females$z[which(females$t==1)]*females$C[which(females$t==2)])
mARS0<-glm(ARS~1+C+z,data=females[which(females$t==1 | females$t==2),],family=poisson)
summary(mARS0)
intercept<-mARS0$coefficients[1]
dXdz<-mARS0$coefficients["z"]
dXdk<-mARS0$coefficients["C"]
dXdkz<-mARS0$coefficients["C:z"] ; if(is.na(dXdkz)){dXdkz<-0}
dXdkz
Zt0<-mean(females$z[which(females$t==1)])
kt0<-mean(females$C[which(females$t==1)])
Zt1<-mean(females$z[which(females$t==2)])
kt1<-mean(females$C[which(females$t==2)])
Xtt<-mean(log(females$ARS[which(females$t==1)]))
XTT<-mean(log(females$ARS[which(females$t==2)]))
XtT<-intercept+Zt0*dXdz+kt1*dXdk
XtT
Xtt
intercept+Zt1*dXdz+kt1*dXdk
XTT
intercept+Zt2*dXdz+kt2*dXdk
intercept+Zt0*dXdz+kt0*dXdk
XTt<-intercept+Zt1*dXdz+kt0*dXdk
XTt
Xtt<-mean(log(females$ARS[which(females$t==1)]))
Xtt
intercept+Zt1*dXdz+kt1*dXdk
AX<-as.data.frame(matrix(data=c(Xtt,XTt,XtT,XTT,0,1,0,1,0,0,1,1),ncol=3))
m1X<-(lm(V1~V2*V3,data=AX))
m1X
0.5*(XTT-XtT + XTt-Xtt)
0.5*(XTT-XTt + XtT-Xtt)
m1X<-(lm(V1~V2+V3,data=AX))
0.5*(XTT-XtT + XTt-Xtt)
0.5*(XTT-XTt + XtT-Xtt)
max(females$t)
evol<-vector(length=max(females$t)-1)
evol
ecol<-vector(length=max(females$t)-1)
evol<-vector(length=max(females$t)-1)
ecol<-vector(length=max(females$t)-1)
for (tempus in 2:max(females$t))
{
mARS0<-glm(ARS~1+C+z,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS0$coefficients["z"]
dXdk<-mARS0$coefficients["C"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
Xtt<-mean(log(females$ARS[which(females$t==(tempus-1))])) # not exactly intercept+Zt0*dXdz+kt0*dXdk because impossible to account for the interaction (??)
XTT<-mean(log(females$ARS[which(females$t==tempus)]))# not exactly intercept+Zt1*dXdz+kt1*dXdk because impossible to account for the interaction (??)
XtT<-intercept+Zt0*dXdz+kt1*dXdk
XTt<-intercept+Zt1*dXdz+kt0*dXdk
AX<-as.data.frame(matrix(data=c(Xtt,XTt,XtT,XTT,0,1,0,1,0,0,1,1),ncol=3))
m1X<-(lm(V1~V2+V3,data=AX))
evol[tempus-1]<-0.5*(XTT-XtT + XTt-Xtt)
ecol[tempus-1]<-0.5*(XTT-XTt + XtT-Xtt)
}
tempus
evol
ecol
mARS0<-glm(ARS~1+C+z,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
mARS0
intercept<-mARS0$coefficients[1]
dXdz<-mARS0$coefficients["z"]
dXdk<-mARS0$coefficients["C"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
Xtt<-mean(log(females$ARS[which(females$t==(tempus-1))])) # not exactly intercept+Zt0*dXdz+kt0*dXdk because impossible to account for the interaction (??)
XTT<-mean(log(females$ARS[which(females$t==tempus)]))# not exactly intercept+Zt1*dXdz+kt1*dXdk because impossible to account for the interaction (??)
XtT<-intercept+Zt0*dXdz+kt1*dXdk
XTt<-intercept+Zt1*dXdz+kt0*dXdk
AX<-as.data.frame(matrix(data=c(Xtt,XTt,XtT,XTT,0,1,0,1,0,0,1,1),ncol=3))
m1X<-(lm(V1~V2+V3,data=AX))
AX
XTT<-mean(log(females$ARS[which(females$t==tempus)]))# not exactly intercept+Zt1*dXdz+kt1*dXdk because impossible to account for the interaction (??)
XTT
females$ARS[which(females$t==tempus)]
log(females$ARS[which(females$t==tempus)])
plot(density(exp(females$ARS)))#very grossly gaussian distribution
intercept+Zt0*dXdz+kt0*dXdk
Xtt<-mean(log(females$ARS[which(females$t==(tempus-1))])) # not exactly intercept+Zt0*dXdz+kt0*dXdk because impossible to account for the interaction (??)
Xtt
log(mean(females$ARS[which(females$t==(tempus-1))]))
(mean(females$ARS[which(females$t==(tempus-1))]))
exp(intercept+Zt0*dXdz+kt0*dXdk)
exp(intercept+Zt0*females$z[which(females$t==(tempus-1))]+kt1*females$z[which(females$t==(tempus-1))])
exp(intercept+Zt0*females$z[which(females$t==(tempus-1))]+kt1*females$C[which(females$t==(tempus-1))])
females$z[which(females$t==(tempus-1))]
Zt0*females$z[which(females$t==(tempus-1))]
kt1
females$C[which(females$t==(tempus-1))]
intercept
intercept+Zt0*females$z[which(females$t==(tempus-1))]+kt1*females$C[which(females$t==(tempus-1))]
intercept+Zt0*dXdz+kt1*dXdk
dXdk
exp(intercept+females$z[which(females$t==(tempus-1))]*dXdz+females$C[which(females$t==(tempus-1))]*dXdk)
mean(exp(intercept+females$z[which(females$t==(tempus-1))]*dXdz+females$C[which(females$t==(tempus-1))]*dXdk))
Xtt
Xtt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
Xtt
evol<-vector(length=max(females$t)-1)
ecol<-vector(length=max(females$t)-1)
for (tempus in 2:max(females$t))
{
mARS0<-glm(ARS~1+C+z,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS0$coefficients["z"]
dXdk<-mARS0$coefficients["C"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
Xtt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XTT<-mean(females$ARS[which(females$t==tempus)])# not exactly exp(intercept+Zt1*dXdz+kt1*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XtT<-exp(intercept+Zt0*dXdz+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTt<-exp(intercept+Zt1*dXdz+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
AX<-as.data.frame(matrix(data=c(Xtt,XTt,XtT,XTT,0,1,0,1,0,0,1,1),ncol=3))
m1X<-(lm(V1~V2+V3,data=AX))
evol[tempus-1]<-0.5*(XTT-XtT + XTt-Xtt)
ecol[tempus-1]<-0.5*(XTT-XTt + XtT-Xtt)
}
plot(evol)
plot(ecol)
plot(evol/(ecol+evol)
)
ecol+evol
evol
plot(abs(evol)/(abs(ecol)+abs(evol)))
plot(evol)
plot(ecol)
(abs(evol)/(abs(ecol)+abs(evol)))
mean(abs(evol)/(abs(ecol)+abs(evol)))
mean(abs(evol)/(abs(ecol)))
plot(females$ARS)
tapply(X=females$ARS,INDEX=females$t,FUN=mean)
females$ARS
plot(tapply(X=females$ARS,INDEX=females$t,FUN=mean))
plot(Camemberts,popSize)
popsize<-table(popfile$t)
popsize
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)))
points(evol,type="l",col="red")
evol
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(0,6))#log to see better what is going on at g13
points(evol,type="l",col="red")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(0,6))#log to see better what is going on at g13
points(abs(evol),type="l",col="red")
points(log(abs(evol)),type="l",col="red")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(0,6))#log to see better what is going on at g13
points(log(abs(evol)),type="l",col="red")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(0,6))#log to see better what is going on at g13
points(abs(evol),type="l",col="red")
points(abs(ecol),type="l",col="blue")
points(evol/max(evol),type="l",col="red")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(0,6))#log to see better what is going on at g13
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-6,6))#log to see better what is going on at g13
points(evol/max(evol),type="l",col="red")
points(evol/sd(evol),type="l",col="red")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-6,6))#log to see better what is going on at g13
points(evol/sd(evol),type="l",col="red")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-6,6))#log to see better what is going on at g13
points(evol/sd(evol),x=2:30,type="l",col="red")
points(ecol/sd(ecol),type="l",col="blue")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-6,6))#log to see better what is going on at g13
points(evol/sd(evol),x=2:30,type="l",col="red")
points(ecol/sd(ecol),x=2:30,type="l",col="blue")
evol/ecol
points(evol/ecol,x=2:30,type="l",col="green")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-6,6))#log to see better what is going on at g13
points(evol/sd(evol),x=2:30,type="l",col="red")
points(ecol/sd(ecol),x=2:30,type="l",col="blue")
points(abs(evol)/abs(ecol),x=2:30,type="l",col="green")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-1,1))#log to see better what is going on at g13
points(evol/sd(evol),x=2:30,type="l",col="red")
points(ecol/sd(ecol),x=2:30,type="l",col="blue")
points(abs(evol)/abs(ecol),x=2:30,type="l",col="green")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-6,6))#log to see better what is going on at g13
points(evol/sd(evol),x=2:30,type="l",col="red")
points(ecol/sd(ecol),x=2:30,type="l",col="blue")
points(abs(evol)/abs(ecol),x=2:30,type="l",col="green")
mean(abs(evol)/abs(ecol))
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-5,6))#log to see better what is going on at g13
points(evol/sd(evol),x=2:30,type="l",col="red")
points(ecol/sd(ecol),x=2:30,type="l",col="blue")
points(abs(evol)/abs(ecol),x=2:30,type="l",col="green")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-5,6),type="b")#log to see better what is going on at g13
points(evol/sd(evol),x=2:30,type="l",col="red")
points(ecol/sd(ecol),x=2:30,type="l",col="blue")
points(abs(evol)/abs(ecol),x=2:30,type="l",col="green")
legend(x="bottomright",legend=c("Noff","Evol","Ecol"),col=c("black","red","blue"),type=c("b","l","l"))
legend(x="bottomright",legend=c("Noff","Evol","Ecol"),col=c("black","red","blue"))
mean(abs(evol)/abs(ecol))
legend(x="bottomright",legend=c("Noff","Evol","Ecol"),col=c("black","red","blue"),lwd=2)
legend(x="bottomright",legend=c("Noff","Evol","Ecol","Abs(evol/ecol)"),col=c("black","red","blue","green"),lwd=2)
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-5,6),type="b")#log to see better what is going on at g13
points(evol/sd(evol),x=2:30-0.5,type="l",col="red")
points(ecol/sd(ecol),x=2:30-0.5,type="l",col="blue")
points(abs(evol)/abs(ecol),x=2:30,type="l",col="green")
points(abs(evol)/abs(ecol),x=2:30-0.5,type="l",col="green")
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-5,6),type="b")#log to see better what is going on at g13
points(evol/sd(evol),x=2:30-0.5,type="l",col="red")
points(ecol/sd(ecol),x=2:30-0.5,type="l",col="blue")
points(abs(evol)/abs(ecol),x=2:30-0.5,type="l",col="green")
legend(x="bottomright",legend=c("Noff","Evol","Ecol","Abs(evol/ecol)"),col=c("black","red","blue","green"),lwd=2)
mARS1<-glm(ARS~1+C+z+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
mARS1
summary(mARS1)
gt1<-mean(females$bvs[which(females$t==tempus)])
gt1
gt0<-mean(females$bvs[which(females$t==(tempus-1))])
gt0
mARS1<-glm(ARS~1+C+z+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS1$coefficients["z"]
dXdk<-mARS1$coefficients["C"]
dXdg<-mARS1$coefficients["bvs"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
gt0<-mean(females$bvs[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
gt1<-mean(females$bvs[which(females$t==tempus)])
Xttt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XTTT<-mean(females$ARS[which(females$t==tempus)])# not exactly exp(intercept+Zt1*dXdz+kt1*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XttT<-exp(intercept+Zt0*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTt<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTT<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtt<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtT<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTTt<-exp(intercept+Zt1*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
AX<-as.data.frame(matrix(data=c(Xtt,XTt,XtT,XTT,0,1,0,1,0,0,1,1),ncol=3))
AX
AX<-data.frame(c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT),c(0,0,0,0,1,1,1,1))
AX
AX<-data.frame(c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT),c(0,0,0,0,1,1,1,1),c(0,0,1,1,0,0,1,1),c(0,1,0,1,0,1,0,1))
AX
names(AX)
names(AX)<-c("X","Z","G","K")
AX
m1X<-(lm(X~Z+G+K,data=AX))
m1X
m1X$coefficients["G"]
evol<-vector(length=max(females$t)-1)
plas<-vector(length=max(females$t)-1)
ecol<-vector(length=max(females$t)-1)
for (tempus in 2:max(females$t))
{
mARS1<-glm(ARS~1+C+z+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS1$coefficients["z"]
dXdk<-mARS1$coefficients["C"]
dXdg<-mARS1$coefficients["bvs"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
gt0<-mean(females$bvs[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
gt1<-mean(females$bvs[which(females$t==tempus)])
Xttt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XTTT<-mean(females$ARS[which(females$t==tempus)])# not exactly exp(intercept+Zt1*dXdz+kt1*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XttT<-exp(intercept+Zt0*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTt<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTT<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtt<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtT<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTTt<-exp(intercept+Zt1*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
AX<-as.data.frame(matrix(data=c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT,0,1,0,1,0,0,1,1),ncol=4))
AX<-data.frame(c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT),c(0,0,0,0,1,1,1,1),c(0,0,1,1,0,0,1,1),c(0,1,0,1,0,1,0,1))
names(AX)<-c("X","Z","G","K")
m1X<-(lm(X~Z+G+K,data=AX))
evol[tempus-1]<-m1X$coefficients["G"]
plas[tempus-1]<-m1X$coefficients["Z"]
ecol[tempus-1]<-m1X$coefficients["Z"]
}
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-5,6),type="b")#log to see better what is going on at g13
points(evol/sd(evol),x=2:30-0.5,type="l",col="red")
points(ecol/sd(ecol),x=2:30-0.5,type="l",col="blue")
points(plas/sd(evol),x=2:30-0.5,type="l",col="purple")
plas
evol
ecol
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-0.5,0.5),type="b")#log to see better what is going on at g13
points(evol/sd(evol),x=2:30-0.5,type="l",col="red")
points(plas/sd(evol),x=2:30-0.5,type="l",col="purple")
points(ecol/sd(ecol),x=2:30-0.5,type="l",col="blue")
evol<-vector(length=max(females$t)-1)
plas<-vector(length=max(females$t)-1)
ecol<-vector(length=max(females$t)-1)
for (tempus in 2:max(females$t))
{
mARS1<-glm(ARS~1+C+I(z-bvs)+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS1$coefficients["z"]
dXdk<-mARS1$coefficients["C"]
dXdg<-mARS1$coefficients["bvs"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
gt0<-mean(females$bvs[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
gt1<-mean(females$bvs[which(females$t==tempus)])
Xttt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XTTT<-mean(females$ARS[which(females$t==tempus)])# not exactly exp(intercept+Zt1*dXdz+kt1*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XttT<-exp(intercept+Zt0*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTt<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTT<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtt<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtT<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTTt<-exp(intercept+Zt1*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
AX<-as.data.frame(matrix(data=c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT,0,1,0,1,0,0,1,1),ncol=4))
AX<-data.frame(c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT),c(0,0,0,0,1,1,1,1),c(0,0,1,1,0,0,1,1),c(0,1,0,1,0,1,0,1))
names(AX)<-c("X","Z","G","K")
m1X<-(lm(X~Z+G+K,data=AX))
evol[tempus-1]<-m1X$coefficients["G"]
plas[tempus-1]<-m1X$coefficients["Z"]
ecol[tempus-1]<-m1X$coefficients["Z"]
}
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-0.5,0.5),type="b")#log to see better what is going on at g13
points(evol/sd(evol),x=2:30-0.5,type="l",col="red")
points(plas/sd(evol),x=2:30-0.5,type="l",col="purple")
evol
mARS1<-glm(ARS~1+C+I(z-bvs)+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
mARS1
mARS1<-glm(ARS~1+C+z+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
mARS1
evol<-vector(length=max(females$t)-1)
plas<-vector(length=max(females$t)-1)
ecol<-vector(length=max(females$t)-1)
for (tempus in 2:max(females$t))
{
mARS1<-glm(ARS~1+C+z+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS1$coefficients["z"]
dXdk<-mARS1$coefficients["C"]
dXdg<-mARS1$coefficients["bvs"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
gt0<-mean(females$bvs[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
gt1<-mean(females$bvs[which(females$t==tempus)])
Xttt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XTTT<-mean(females$ARS[which(females$t==tempus)])# not exactly exp(intercept+Zt1*dXdz+kt1*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XttT<-exp(intercept+Zt0*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTt<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTT<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtt<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtT<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTTt<-exp(intercept+Zt1*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
AX<-as.data.frame(matrix(data=c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT,0,1,0,1,0,0,1,1),ncol=4))
AX<-data.frame(c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT),c(0,0,0,0,1,1,1,1),c(0,0,1,1,0,0,1,1),c(0,1,0,1,0,1,0,1))
names(AX)<-c("X","Z","G","K")
m1X<-(lm(X~Z+G+K,data=AX))
evol[tempus-1]<-m1X$coefficients["G"]
plas[tempus-1]<-m1X$coefficients["Z"]
ecol[tempus-1]<-m1X$coefficients["Z"]
}
evol
plas
ecol
plot(evol)
evol<-vector(length=max(females$t)-1)
plas<-vector(length=max(females$t)-1)
ecol<-vector(length=max(females$t)-1)
#for (tempus in 2:max(females$t))
for (tempus in 2:11)
{
mARS1<-glm(ARS~1+C+z+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS1$coefficients["z"]
dXdk<-mARS1$coefficients["C"]
dXdg<-mARS1$coefficients["bvs"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
gt0<-mean(females$bvs[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
gt1<-mean(females$bvs[which(females$t==tempus)])
Xttt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XTTT<-mean(females$ARS[which(females$t==tempus)])# not exactly exp(intercept+Zt1*dXdz+kt1*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XttT<-exp(intercept+Zt0*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTt<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTT<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtt<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtT<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTTt<-exp(intercept+Zt1*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
AX<-as.data.frame(matrix(data=c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT,0,1,0,1,0,0,1,1),ncol=4))
AX<-data.frame(c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT),c(0,0,0,0,1,1,1,1),c(0,0,1,1,0,0,1,1),c(0,1,0,1,0,1,0,1))
names(AX)<-c("X","Z","G","K")
m1X<-(lm(X~Z+G+K,data=AX))
evol[tempus-1]<-m1X$coefficients["G"]
plas[tempus-1]<-m1X$coefficients["Z"]
ecol[tempus-1]<-m1X$coefficients["Z"]
}
plot(evol)
popfile[which(popfile$t==13),]
evol/sd(evol)
evol<-vector(length=max(females$t)-1)
plas<-vector(length=max(females$t)-1)
ecol<-vector(length=max(females$t)-1)
for (tempus in 2:max(females$t))
{
mARS1<-glm(ARS~1+C+z+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS1$coefficients["z"]
dXdk<-mARS1$coefficients["C"]
dXdg<-mARS1$coefficients["bvs"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
gt0<-mean(females$bvs[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
gt1<-mean(females$bvs[which(females$t==tempus)])
Xttt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XTTT<-mean(females$ARS[which(females$t==tempus)])# not exactly exp(intercept+Zt1*dXdz+kt1*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XttT<-exp(intercept+Zt0*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTt<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTT<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtt<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtT<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTTt<-exp(intercept+Zt1*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
AX<-as.data.frame(matrix(data=c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT,0,1,0,1,0,0,1,1),ncol=4))
AX<-data.frame(c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT),c(0,0,0,0,1,1,1,1),c(0,0,1,1,0,0,1,1),c(0,1,0,1,0,1,0,1))
names(AX)<-c("X","Z","G","K")
m1X<-(lm(X~Z+G+K,data=AX))
evol[tempus-1]<-m1X$coefficients["G"]
plas[tempus-1]<-m1X$coefficients["Z"]
ecol[tempus-1]<-m1X$coefficients["Z"]
}
evol/sd(evol)
sd(evol)
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-5,6),type="b")#log to see better what is going on at g13
points(evol,x=2:30-0.5,type="l",col="red")
points(plas,x=2:30-0.5,type="l",col="purple")
points(ecol,x=2:30-0.5,type="l",col="blue")
evol<-vector(length=max(females$t)-1)
plas<-vector(length=max(females$t)-1)
ecol<-vector(length=max(females$t)-1)
for (tempus in 2:max(females$t))
{
mARS1<-glm(ARS~1+C+z+bvs,data=females[which(females$t==(tempus-1) | females$t==tempus),],family=poisson)
intercept<-mARS0$coefficients[1]
dXdz<-mARS1$coefficients["z"]
dXdk<-mARS1$coefficients["C"]
dXdg<-mARS1$coefficients["bvs"]
Zt0<-mean(females$z[which(females$t==(tempus-1))])
kt0<-mean(females$C[which(females$t==(tempus-1))])
gt0<-mean(females$bvs[which(females$t==(tempus-1))])
Zt1<-mean(females$z[which(females$t==tempus)])
kt1<-mean(females$C[which(females$t==tempus)])
gt1<-mean(females$bvs[which(females$t==tempus)])
Xttt<-mean(females$ARS[which(females$t==(tempus-1))]) # not exactly exp(intercept+Zt0*dXdz+kt0*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XTTT<-mean(females$ARS[which(females$t==tempus)])# not exactly exp(intercept+Zt1*dXdz+kt1*dXdk) I do not want to account for the interaction (??) as it is problematic for XtT and XTt
XttT<-exp(intercept+Zt0*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTt<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XtTT<-exp(intercept+Zt0*dXdz+gt1*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtt<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTtT<-exp(intercept+Zt1*dXdz+gt0*dXdg+kt1*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
XTTt<-exp(intercept+Zt1*dXdz+gt1*dXdg+kt0*dXdk)#this is done with population mean assumption. Would be impossible on an individual basis
AX<-as.data.frame(matrix(data=c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT,0,1,0,1,0,0,1,1),ncol=4))
AX<-data.frame(c(Xttt,XttT,XtTt,XtTT,XTtt,XTtT,XTTt,XTTT),c(0,0,0,0,1,1,1,1),c(0,0,1,1,0,0,1,1),c(0,1,0,1,0,1,0,1))
names(AX)<-c("X","Z","G","K")
m1X<-(lm(X~Z+G+K,data=AX))
evol[tempus-1]<-m1X$coefficients["G"]
plas[tempus-1]<-m1X$coefficients["Z"]
ecol[tempus-1]<-m1X$coefficients["K"]
}
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-5,6),type="b")#log to see better what is going on at g13
points(evol,x=2:30-0.5,type="l",col="red")
points(plas,x=2:30-0.5,type="l",col="purple")
points(ecol,x=2:30-0.5,type="l",col="blue")
points(abs(evol/(ecol+plas),x=2:30-0.5,type="l",col="green")
points(abs(evol/(ecol+plas)),x=2:30-0.5,type="l",col="green")
points(abs(evol/(ecol+plas)),x=2:30-0.5,type="l",col="green")
abs(evol/(ecol+plas))
mean(abs(evol/(ecol+plas)))
mean(abs(evol)/(abs(ecol)+abs(plas)))
plot(log(tapply(X=females$ARS,INDEX=females$t,FUN=mean)),ylim=c(-5,6),type="b")#log to see better what is going on at g13
points(evol,x=2:30-0.5,type="l",col="red")
points(plas,x=2:30-0.5,type="l",col="purple")
points(ecol,x=2:30-0.5,type="l",col="blue")
points(abs(evol)/(abs(ecol)+abs(plas)),x=2:30-0.5,type="l",col="green")
plot(abs(evol)/(abs(ecol)+abs(plas)),x=2:30-0.5,type="l",col="green")
plot(abs(evol)/(abs(ecol)+abs(plas)),x=2:30-0.5,type="l",col="green",ylim=c(0,1))
plot(abs(evol)/(abs(ecol)+abs(plas)+abs(evol)),x=2:30-0.5,type="l",col="green",ylim=c(0,1))
plot(abs(evol)/(abs(ecol)+abs(plas)+abs(evol)),x=2:30-0.5,type="l",col="red",ylim=c(0,1))
points(abs(plas)/(abs(ecol)+abs(plas)+abs(evol)),x=2:30-0.5,type="l",col="purple")
plot(abs(ecol)/(abs(ecol)+abs(plas)+abs(evol)),x=2:30-0.5,type="l",col="blue")
plot(abs(evol)/(abs(ecol)+abs(plas)+abs(evol)),x=2:30-0.5,type="l",col="red",ylim=c(0,1))
points(abs(plas)/(abs(ecol)+abs(plas)+abs(evol)),x=2:30-0.5,type="l",col="purple")
points(abs(ecol)/(abs(ecol)+abs(plas)+abs(evol)),x=2:30-0.5,type="l",col="blue")
View(popfile)
plot(popfile$bvs,x=popfile$t)#there is not much genetic variance left after 15 years!
sd(evol)
